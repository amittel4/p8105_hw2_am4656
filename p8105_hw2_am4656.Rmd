---
title: "p8105_hw2_am4656"
author: "Aaron Mittel"
date: "2022-10-04"
output: github_document
---

```{r setup, echo=FALSE, message = FALSE}
library(tidyverse)
library(readxl)
```

# Problem 1

_Imported "NYC_Transit_and_Subway_Entrance_and_Exit_Data.csv" from a relative file path to my working directory, cleaned column names, and then selected for only "line, station, name, station latitude / longitude, routes served, entry, vending, entrance type, and ADA compliance" by selecting for the range of columns incorporating those variables and removing unwanted variables. Then, converted the entry variable from character (YES vs NO) to a logical variable using "ifelse"._

```{r data input, echo = FALSE, message = FALSE}
transit_data = read_csv(file = "./NYC_Transit_Subway_Entrance_And_Exit_Data.csv",
  col_types = cols(Route8 = "c", Route9 = "c", Route10 = "c", Route11 = "c")) %>%
  janitor::clean_names() %>%
  select(line:ada, -exit_only, -staffing, -staff_hours) %>%
  mutate(entry = ifelse(entry == "YES", TRUE, FALSE))
```

Following these procedures, this dataset is now organized into **19 columns and 1868 rows**. The dataset contains variables describing individual tracks/lines of the New York city subway transit system by the associated street (e.g. 4th Avenue) that the track/line runs along, stations along each track/line, individual trains/routes (e.g. A, B, C, or D) that run on each track/line, geographic positions of each station, and basic features of each station (whether a vending machine is present, stairs or elevator used for access, whether the station is ADA compliant).

The data is tidier than it once was. However, it does have some redundancy and can be improved. Route # should be a variable and route should also be a variable (done below).

_We can select for unique combinations of station name, line, and ADA accesability using the "distinct" function"._

```{r, echo = FALSE, message = FALSE}
transit_data_distinct_stations = transit_data %>%
  select(line, station_name) %>%
  distinct
```

* There are **`r nrow(transit_data_distinct_stations)`** distinct stations.

```{r, echo = FALSE, message = FALSE}
transit_data_distinct_ada = transit_data %>%
  filter(ada == TRUE) %>%
  distinct(line, station_name)
```

* There are **`r nrow(transit_data_distinct_ada)`** distinct stations that are ADA compliant.

_We can compute the proportion of station entrances without vending that allow entrance by first excluding station entrances that do not allow vending. Then, we can take the mean of the entry variable (which will produce the desired proportion because R will coerce logical to numeric in cases like this)._

```{r message=FALSE, include=FALSE}
transit_data %>%
  filter(vending == "NO") %>%
  pull(entry) %>% 
  mean()
```

* The proportion of station entrances without vending that allow entrance is thus **`r (transit_data %>% filter(vending == "NO") %>% pull(entry) %>% mean)`**.

_We can identify distinct stations that serve the A train and are ADA compliant by tidying the data to convert `route` from wide to long format and filtering to focus on the A train._

```{r, echo = FALSE, message = FALSE}
transit_data %>% 
pivot_longer(
    route1:route11,
    names_to = "route_num",
    values_to = "route") %>% 
  filter(route == "A", ada == TRUE) %>% 
  select(station_name, line) %>% 
  distinct
```

Thus, there are only **17** stations that serve the A train that are ADA compliant.

## Problem 2

_Reading Mr. Trash Wheel into R Studio, self-named first sheet in the Excel file, skipping the first row (which is just an image in the original Excel file) and the last row (which appears to be summed column values), using reasonable variable names, omitting rows that do not include dumpster-specific data._

```{r problem 2 data input, echo = FALSE, message = FALSE}
mr_trash_wheel = read_excel("./Trash Wheel Collection Data.xlsx", sheet = "Mr. Trash Wheel", range = cell_rows(2:549)) %>%
  janitor::clean_names() %>%
  select(dumpster:homes_powered)
```

